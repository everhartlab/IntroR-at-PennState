<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title></title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Intro to R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="installation.html">Before the Workshop</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Workshop
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Part1-Introduction.html">Part 1: Introduction to R</a>
    </li>
    <li>
      <a href="Part2-Analysis.html">Part 2: Data Manipulation and Analysis</a>
    </li>
    <li>
      <a href="Part3-Visualization.html">Part 3: Data Visualization</a>
    </li>
  </ul>
</li>
<li>
  <a href="quiz.html">Quiz</a>
</li>
<li>
  <a href="refs.html">Links</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<div id="lets-practice" class="section level1">
<h1>Let’s practice!</h1>
<p>In this section we will cover:</p>
<ol style="list-style-type: decimal">
<li>Working directories</li>
<li>Reading in data</li>
<li>Advanced data manipulation</li>
<li>Statistical Analysis</li>
</ol>
<div id="step-1-working-directories" class="section level2">
<h2>Step 1: Working Directories</h2>
<p>A working directory is the folder on your computer where you are currently working. You can find out your current working directory by typing <code>getwd()</code></p>
<pre class="r"><code>&gt; getwd()</code></pre>
<pre><code>[1] &quot;/Users/severhart2/Documents/IntroR-at-PennState&quot;</code></pre>
<p>If you’ve downloaded and un-zipped this directory to your desktop, you might see something like <code>/Users/&lt;yourname&gt;/Desktop/IntroR_Workshop</code>. This is the<br />
default place where R will begin reading and writing files. For example, you<br />
can use the function <code>list.files()</code> to view the files in your current working directory. These are the same files that we downloaded earlier. If you’re using Rstudio, you can compare the file list with the “Files” tab in the bottom right panel.</p>
<p>In order to use <code>list.files()</code>, we should provide it with a file path. We can provide it a “.”, which means “here” to most computer programs.</p>
<pre class="r"><code>&gt; list.files(&quot;.&quot;)</code></pre>
<pre><code>[1] &quot;data&quot;                      &quot;docs&quot;                     
[3] &quot;IntroR-at-PennState.Rproj&quot; &quot;LICENSE&quot;                  
[5] &quot;Makefile&quot;                  &quot;Part1-Introduction.R&quot;     
[7] &quot;Part2-Analysis.R&quot;          &quot;Part3-Visualization.R&quot;    
[9] &quot;README.md&quot;                </code></pre>
<p>You can see that the first entry in here is “data”. This is where we’ve placed the fungicide example data.</p>
<pre class="r"><code>&gt; list.files(&quot;data&quot;)</code></pre>
<pre><code>[1] &quot;fungicide_dat.csv&quot; &quot;README.md&quot;        </code></pre>
</div>
<div id="step-2-reading-in-data" class="section level2">
<h2>Step 2: Reading in Data</h2>
<p>We can use the <code>read.csv()</code> function to read (or import) these data into R. It’s important to remember that while in R, these data are simply a copy kept <em>in memory</em>, not on the disk, so we don’t have to worry too much about accidentally deleting the data.</p>
<p>How do we use the <code>read.csv()</code> function?</p>
<pre class="r"><code>&gt; ?read.csv</code></pre>
<p>You will notice that the help page describes all the sibling functions, too: <code>read.table()</code>, <code>read.csv2()</code>, <code>read.delim()</code>, <code>read.delim2()</code>. Let’s read the Description and Usage first. All arguments except ‘file’ have a default value (e.g. header = TRUE). You do not need to specify these arguments unless you want to change the default. Let’s use <code>read.csv()</code> with the default values.</p>
<pre class="r"><code>&gt; read.csv(&quot;data/fungicide_dat.csv&quot;)</code></pre>
<pre><code>     Treatment Yield_bu_per_acre Severity
1      Control            173.82      5.5
2      Control            174.23      5.6
3      Control            173.57      5.4
4      Control            173.61      5.4
5      Control            174.19      5.6
6      Control            173.80      5.5
7  Fungicide_A            173.98      5.1
8  Fungicide_A            174.27      5.2
9  Fungicide_A            173.61      5.0
10 Fungicide_A            173.88      5.0
11 Fungicide_A            174.17      5.2
12 Fungicide_A            173.49      5.1
13 Fungicide_B            175.98      4.1
14 Fungicide_B            175.58      3.9
15 Fungicide_B            175.75      4.2
16 Fungicide_B            175.88      4.0
17 Fungicide_B            175.68      4.1
18 Fungicide_B            175.95      4.2</code></pre>
<p>Let’s use <code>read.table()</code> with the default values.</p>
<pre class="r"><code>&gt; read.table(&quot;data/fungicide_dat.csv&quot;)</code></pre>
<pre><code>                                     V1
1  Treatment,Yield_bu_per_acre,Severity
2                    Control,173.82,5.5
3                    Control,174.23,5.6
4                    Control,173.57,5.4
5                    Control,173.61,5.4
6                    Control,174.19,5.6
7                     Control,173.8,5.5
8                Fungicide_A,173.98,5.1
9                Fungicide_A,174.27,5.2
10                 Fungicide_A,173.61,5
11                 Fungicide_A,173.88,5
12               Fungicide_A,174.17,5.2
13               Fungicide_A,173.49,5.1
14               Fungicide_B,175.98,4.1
15               Fungicide_B,175.58,3.9
16               Fungicide_B,175.75,4.2
17                 Fungicide_B,175.88,4
18               Fungicide_B,175.68,4.1
19               Fungicide_B,175.95,4.2</code></pre>
<p>This has two issues:</p>
<ol style="list-style-type: decimal">
<li>The column names are treated as the first row. This is because the default for header is FALSE in <code>read.table()</code>. We should change to header = TRUE.</li>
<li>The data is presented as one column, ‘V1’. This is because the separator for each cell in the data is a “,” and not “”(space). We should change to sep = “,”.</li>
</ol>
<pre class="r"><code>&gt; read.table(&quot;data/fungicide_dat.csv&quot;, header = TRUE, sep = &quot;,&quot;)</code></pre>
<pre><code>     Treatment Yield_bu_per_acre Severity
1      Control            173.82      5.5
2      Control            174.23      5.6
3      Control            173.57      5.4
4      Control            173.61      5.4
5      Control            174.19      5.6
6      Control            173.80      5.5
7  Fungicide_A            173.98      5.1
8  Fungicide_A            174.27      5.2
9  Fungicide_A            173.61      5.0
10 Fungicide_A            173.88      5.0
11 Fungicide_A            174.17      5.2
12 Fungicide_A            173.49      5.1
13 Fungicide_B            175.98      4.1
14 Fungicide_B            175.58      3.9
15 Fungicide_B            175.75      4.2
16 Fungicide_B            175.88      4.0
17 Fungicide_B            175.68      4.1
18 Fungicide_B            175.95      4.2</code></pre>
<p>Now that we have these elements, we can read the data into an object, which we can call “fungicide”. Once we do this, we can check the dimensions to make sure that we have all of the data.</p>
<pre class="r"><code>&gt; fungicide &lt;- read.csv(&quot;data/fungicide_dat.csv&quot;)
&gt; nrow(fungicide)</code></pre>
<pre><code>[1] 18</code></pre>
<pre class="r"><code>&gt; ncol(fungicide)</code></pre>
<pre><code>[1] 3</code></pre>
<p>We can print the data to screen by simply typing its name.</p>
<pre class="r"><code>&gt; fungicide</code></pre>
<pre><code>     Treatment Yield_bu_per_acre Severity
1      Control            173.82      5.5
2      Control            174.23      5.6
3      Control            173.57      5.4
4      Control            173.61      5.4
5      Control            174.19      5.6
6      Control            173.80      5.5
7  Fungicide_A            173.98      5.1
8  Fungicide_A            174.27      5.2
9  Fungicide_A            173.61      5.0
10 Fungicide_A            173.88      5.0
11 Fungicide_A            174.17      5.2
12 Fungicide_A            173.49      5.1
13 Fungicide_B            175.98      4.1
14 Fungicide_B            175.58      3.9
15 Fungicide_B            175.75      4.2
16 Fungicide_B            175.88      4.0
17 Fungicide_B            175.68      4.1
18 Fungicide_B            175.95      4.2</code></pre>
<p>We can use the <code>str()</code> function (short for “structure”) to have a broad overview of what our data looks like. This is useful for data frames with many columns.</p>
<pre class="r"><code>&gt; str(fungicide)</code></pre>
<pre><code>&#39;data.frame&#39;:   18 obs. of  3 variables:
 $ Treatment        : Factor w/ 3 levels &quot;Control&quot;,&quot;Fungicide_A&quot;,..: 1 1 1 1 1 1 2 2 2 2 ...
 $ Yield_bu_per_acre: num  174 174 174 174 174 ...
 $ Severity         : num  5.5 5.6 5.4 5.4 5.6 5.5 5.1 5.2 5 5 ...</code></pre>
<p>We can also use the <code>View()</code> function to look at our data in spreadsheet-style.</p>
<pre class="r"><code>&gt; stop(&quot;
+ 
+      Type View(fungicide) and inspect the data
+      
+      &quot;)</code></pre>
<pre><code>Error in eval(expr, envir, enclos): 

     Type View(fungicide) and inspect the data
     
     </code></pre>
<p>The example data presented here consists of yield (measured in bu/acre) and disease severity (measured on a scale of 1 to 10) of a corn culitvar treated with two fungicides. This trial was conducted to measure the efficacy of the two fungicides to manage disease. The experiment was laid out in a Completely Randomized Design.</p>
<p>In the following exercises, we will answer the following questions:</p>
<ol style="list-style-type: decimal">
<li>What is the mean yield of each treatment group in kg/ha?</li>
<li>What is the percent severity of Control and Fungicide A?</li>
<li>Which fungicide shows better results? (ANOVA)</li>
</ol>
</div>
<div id="step-3-advanced-data-manipulation" class="section level2">
<h2>Step 3: Advanced data manipulation</h2>
<pre class="r"><code>&gt; #</code></pre>
<p>The package ‘dplyr’ provides functions for easy and advanced data manipulation. If we want to use it, we can download the package to our computer with the function <code>install.packages()</code>. This will download a package from CRAN and place it into your R <em>Library</em>, just like a book added to your library.</p>
<pre class="r"><code>&gt; install.packages(&quot;dplyr&quot;)</code></pre>
<pre><code>Error in contrib.url(repos, &quot;source&quot;): trying to use CRAN without setting a mirror</code></pre>
<p>To load this package, like pulling a book off the shelf, we can use the function <code>library()</code>.</p>
<pre class="r"><code>&gt; library(&quot;dplyr&quot;)</code></pre>
<pre><code>Warning: package &#39;dplyr&#39; was built under R version 3.5.1</code></pre>
<pre><code>
Attaching package: &#39;dplyr&#39;</code></pre>
<pre><code>The following objects are masked from &#39;package:stats&#39;:

    filter, lag</code></pre>
<pre><code>The following objects are masked from &#39;package:base&#39;:

    intersect, setdiff, setequal, union</code></pre>
<ol style="list-style-type: decimal">
<li>What is the mean yield of each treatment group in kg/ha?</li>
</ol>
<p>Let’s go step by step to answer this:</p>
<ol style="list-style-type: lower-alpha">
<li>Convert yield data from bu/acre to kg/ha To do this conversion for corn, we need to multiply the yield in bu/acre with 62.77. So, how can we add a column with yield data in kg/ha? We can do this similar to what we learned in Part 1.</li>
</ol>
<p><code>fungicide$Yield_kg_per_ha &lt;- fungicide$Yield_bu_per_acre*62.77</code></p>
<p>We can also use the function <code>mutate()</code> from ‘dplyr’. This adds a new variable using existing variables. The usage of this function is as follows:</p>
<p>mutate(data, new_variable_name = calculation_based_upon_existing_variables)</p>
<pre class="r"><code>&gt; fungicide_1 &lt;- mutate(fungicide, Yield_kg_per_ha = Yield_bu_per_acre*62.77)</code></pre>
<blockquote>
<p>Note: We did not have to use fungicide$Yield_bu_per_acre</p>
</blockquote>
<p>Let’s inspect the data to see what we have</p>
<pre class="r"><code>&gt; fungicide_1</code></pre>
<pre><code>     Treatment Yield_bu_per_acre Severity Yield_kg_per_ha
1      Control            173.82      5.5        10910.68
2      Control            174.23      5.6        10936.42
3      Control            173.57      5.4        10894.99
4      Control            173.61      5.4        10897.50
5      Control            174.19      5.6        10933.91
6      Control            173.80      5.5        10909.43
7  Fungicide_A            173.98      5.1        10920.72
8  Fungicide_A            174.27      5.2        10938.93
9  Fungicide_A            173.61      5.0        10897.50
10 Fungicide_A            173.88      5.0        10914.45
11 Fungicide_A            174.17      5.2        10932.65
12 Fungicide_A            173.49      5.1        10889.97
13 Fungicide_B            175.98      4.1        11046.26
14 Fungicide_B            175.58      3.9        11021.16
15 Fungicide_B            175.75      4.2        11031.83
16 Fungicide_B            175.88      4.0        11039.99
17 Fungicide_B            175.68      4.1        11027.43
18 Fungicide_B            175.95      4.2        11044.38</code></pre>
<p>We have a new column <code>Yield_kg_per_ha</code>. We have two columns with yield and one with severity. We don’t want severity data and want yield data only in kg/ha.</p>
<ol start="2" style="list-style-type: lower-alpha">
<li>Create a new data frame with only <code>Treatment</code> and <code>Yield_kg_per_ha</code> columns We can use the function <code>select()</code> that picks variables by their name.</li>
</ol>
<pre class="r"><code>&gt; fungicide_2 &lt;- select(fungicide_1, Treatment, Yield_kg_per_ha)
&gt; fungicide_2</code></pre>
<pre><code>     Treatment Yield_kg_per_ha
1      Control        10910.68
2      Control        10936.42
3      Control        10894.99
4      Control        10897.50
5      Control        10933.91
6      Control        10909.43
7  Fungicide_A        10920.72
8  Fungicide_A        10938.93
9  Fungicide_A        10897.50
10 Fungicide_A        10914.45
11 Fungicide_A        10932.65
12 Fungicide_A        10889.97
13 Fungicide_B        11046.26
14 Fungicide_B        11021.16
15 Fungicide_B        11031.83
16 Fungicide_B        11039.99
17 Fungicide_B        11027.43
18 Fungicide_B        11044.38</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>Find the mean yield If we want to summarise multiple values to a single value, for example, mean, we can use the function <code>summarize()</code>.</li>
</ol>
<pre class="r"><code>&gt; summarize(fungicide_2, Mean_yield = mean(Yield_kg_per_ha))</code></pre>
<pre><code>  Mean_yield
1    10954.9</code></pre>
<p>Wait, we just got one mean even though we had three different groups (Control, Fungicide_A, Fungicide_B). We need to find the mean for every group. How can we tell R that it needs to group the data according to the treatment?</p>
<ol start="4" style="list-style-type: lower-alpha">
<li>Group data according to treatment We can use the function <code>group_by()</code> for this purpose.</li>
</ol>
<pre class="r"><code>&gt; fungicide_3 &lt;- group_by(fungicide_2, Treatment)
&gt; fungicide_3 </code></pre>
<pre><code># A tibble: 18 x 2
# Groups:   Treatment [3]
   Treatment   Yield_kg_per_ha
   &lt;fct&gt;                 &lt;dbl&gt;
 1 Control              10911.
 2 Control              10936.
 3 Control              10895.
 4 Control              10897.
 5 Control              10934.
 6 Control              10909.
 7 Fungicide_A          10921.
 8 Fungicide_A          10939.
 9 Fungicide_A          10897.
10 Fungicide_A          10914.
11 Fungicide_A          10933.
12 Fungicide_A          10890.
13 Fungicide_B          11046.
14 Fungicide_B          11021.
15 Fungicide_B          11032.
16 Fungicide_B          11040.
17 Fungicide_B          11027.
18 Fungicide_B          11044.</code></pre>
<p>You will notice that <code>fungicide_2</code> and <code>fungicide_3</code> are a little different. <code>fungicide_3</code> is also a “tibble”, which is a form of data frame that gives more information about our data (e.g. what kind of data the columns are). You will notice that Treatment is a factor, while Yield_kg_per_ha is a double (decimal). It also tells us that our data is grouped by Treatment (therefore, it has three groups). To add the grouping information to this data frame, ‘dplyr’ uses a sister package to convert it into a tibble. Also, note that <code>Yield_kg_per_ha</code> is not printing the whole answer (after decimals) and has underlined first two digits. The tibble format is different when we print it, but the same when we use <code>View()</code>. The digits are underlined so that it is easier to read larger numbers. It’s role is similar to a comma. So, ‘10,000’ will have ‘10’ underlined and ‘100,000’ will have ‘100’ underlined.</p>
<ol start="5" style="list-style-type: lower-alpha">
<li>Find the mean yield of every group</li>
</ol>
<pre class="r"><code>&gt; fungicide_4 &lt;- summarize(fungicide_3, Mean_yield = mean(Yield_kg_per_ha))
&gt; fungicide_4</code></pre>
<pre><code># A tibble: 3 x 2
  Treatment   Mean_yield
  &lt;fct&gt;            &lt;dbl&gt;
1 Control         10914.
2 Fungicide_A     10916.
3 Fungicide_B     11035.</code></pre>
<p>Instead of creating different objects everytime, we can perform multiple functions at once and create one final object. We use the pipe operator, %&gt;% , for this purpose. The left hand side of %&gt;% acts as the input on which an operation on the right side is performed. A shortcut to write %&gt;% is <code>ctrl+shift+m</code>.</p>
<pre class="r"><code>&gt; yield_summary &lt;- fungicide %&gt;% 
+   mutate(Yield_kg_per_ha = Yield_bu_per_acre*62.77) %&gt;%  
+   select(Treatment, Yield_kg_per_ha) %&gt;% 
+   group_by(Treatment) %&gt;% 
+   summarise(Mean_yield = mean(Yield_kg_per_ha))</code></pre>
<pre class="r"><code>&gt; yield_summary</code></pre>
<pre><code># A tibble: 3 x 2
  Treatment   Mean_yield
  &lt;fct&gt;            &lt;dbl&gt;
1 Control         10914.
2 Fungicide_A     10916.
3 Fungicide_B     11035.</code></pre>
<pre class="r"><code>&gt; View(yield_summary)</code></pre>
<pre><code>Error in check_for_XQuartz(): X11 library is missing: install XQuartz from xquartz.macosforge.org</code></pre>
<p>We answered our first question!</p>
<p>You will notice that on the console below, the code for creating <code>yield_summary</code> has <code>+</code> signs before every line. The plus signs just indicate that R is waiting for the code to be finished. This sign also appears when we forget to put a closing paranthesis ‘)’. Try this:</p>
<pre class="r"><code>&gt; str(yield_summary
+ 
+ )</code></pre>
<pre><code>Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:   3 obs. of  2 variables:
 $ Treatment : Factor w/ 3 levels &quot;Control&quot;,&quot;Fungicide_A&quot;,..: 1 2 3
 $ Mean_yield: num  10914 10916 11035</code></pre>
<p>Let’s go to our second question.</p>
<ol start="2" style="list-style-type: decimal">
<li>What is the percent severity of Control and Fungicide A?</li>
</ol>
<p>First, we need to create a new data frame where we only have severity data for Control and Fungicide A. If we want to filter a data frame based upon specific values of a variable, we can use the function <code>filter()</code>.</p>
<pre class="r"><code>&gt; filter(fungicide, Treatment == &quot;Control&quot; | Treatment == &quot;Fungicide_A&quot;)</code></pre>
<pre><code>     Treatment Yield_bu_per_acre Severity
1      Control            173.82      5.5
2      Control            174.23      5.6
3      Control            173.57      5.4
4      Control            173.61      5.4
5      Control            174.19      5.6
6      Control            173.80      5.5
7  Fungicide_A            173.98      5.1
8  Fungicide_A            174.27      5.2
9  Fungicide_A            173.61      5.0
10 Fungicide_A            173.88      5.0
11 Fungicide_A            174.17      5.2
12 Fungicide_A            173.49      5.1</code></pre>
<p>The treatment column should either be equal (<code>==</code>) to Control OR (<code>|</code>) Fungicide_A. We can also write the same expression as:</p>
<pre class="r"><code>&gt; filter(fungicide, Treatment != &quot;Fungicide_B&quot;)</code></pre>
<pre><code>     Treatment Yield_bu_per_acre Severity
1      Control            173.82      5.5
2      Control            174.23      5.6
3      Control            173.57      5.4
4      Control            173.61      5.4
5      Control            174.19      5.6
6      Control            173.80      5.5
7  Fungicide_A            173.98      5.1
8  Fungicide_A            174.27      5.2
9  Fungicide_A            173.61      5.0
10 Fungicide_A            173.88      5.0
11 Fungicide_A            174.17      5.2
12 Fungicide_A            173.49      5.1</code></pre>
<p>The treatment column should not be equal to (<code>!=</code>) to Fungicide_B. So, it will have everything except Fungicide B (“Control” and “Fungicide_A”).</p>
<p>After filtering, we need to add a column <code>Percent_Severity</code>, where severity is measured in percent and not on a scale of 1 to 10. Any guess on which function should we use? Let’s perform all operations in one go.</p>
<pre class="r"><code>&gt; severity_dat &lt;- fungicide %&gt;% 
+   filter(Treatment == &quot;Control&quot; | Treatment == &quot;Fungicide_A&quot;) %&gt;% 
+   mutate(Percent_Severity = Severity/10*100) %&gt;% 
+   select(Treatment, Percent_Severity)</code></pre>
<pre class="r"><code>&gt; severity_dat</code></pre>
<pre><code>     Treatment Percent_Severity
1      Control               55
2      Control               56
3      Control               54
4      Control               54
5      Control               56
6      Control               55
7  Fungicide_A               51
8  Fungicide_A               52
9  Fungicide_A               50
10 Fungicide_A               50
11 Fungicide_A               52
12 Fungicide_A               51</code></pre>
<p>If we wanted to use these data as a table in a paper, we should export it to a csv file. We can do this using the function <code>write.table()</code>. Before that, let’s create a new directory (or folder) named results. We can do this using the function <code>dir.create()</code>.</p>
<pre class="r"><code>&gt; dir.create(&quot;results&quot;)
&gt; write.table(severity_dat, file = &quot;results/severity_dat.csv&quot;, sep = &quot;,&quot;, 
+             col.names = TRUE, 
+             row.names = FALSE)</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Which fungicide shows better results? (ANOVA)</li>
</ol>
</div>
<div id="step-4-statistical-analysis" class="section level2">
<h2>Step 4: Statistical Analysis</h2>
<p>Let’s do ANOVA for yield and severity data. We can use alpha level = 0.05. If we do an internet search for ANOVA in R, you will find that function <code>aov</code> is appropriate for this. How do we use <code>aov</code>?</p>
<pre class="r"><code>&gt; ?aov</code></pre>
<p>This function takes in a formula to be tested. To find if the independent variable (<code>Treatment</code>) had an effect on the dependent variable (<code>Yield_bu_per_acre</code>), the formula should be written as ‘dependent_variable ~ independent_variable’. If we used blocks in our experimental design, the formula can be modified to ‘dependent_variable ~ independent_variable + block’. The function also takes in a data frame in which these variables are present.</p>
<p>Let’s use this function.</p>
<pre class="r"><code>&gt; aov(formula=Yield_bu_per_acre ~ Treatment, data=fungicide) </code></pre>
<pre><code>Call:
   aov(formula = Yield_bu_per_acre ~ Treatment, data = fungicide)

Terms:
                Treatment Residuals
Sum of Squares  14.722711  0.992333
Deg. of Freedom         2        15

Residual standard error: 0.2572072
Estimated effects may be unbalanced</code></pre>
<p>As mentioned in the ‘Description’, <code>aov</code> fits an ANOVA model to an experimental design. Let’s check the ‘Value’ section of the help page so we know what does it return. It returns an object, which can further be explored with <code>print()</code> and <code>summary()</code>. Let’s assign it to an object so that we can use <code>print()</code> and <code>summary()</code> on it.</p>
<pre class="r"><code>&gt; fit_yield &lt;- aov(formula=Yield_bu_per_acre ~ Treatment, data=fungicide) </code></pre>
<pre class="r"><code>&gt; print(fit_yield) </code></pre>
<pre><code>Call:
   aov(formula = Yield_bu_per_acre ~ Treatment, data = fungicide)

Terms:
                Treatment Residuals
Sum of Squares  14.722711  0.992333
Deg. of Freedom         2        15

Residual standard error: 0.2572072
Estimated effects may be unbalanced</code></pre>
<pre class="r"><code>&gt; summary(fit_yield) # This is what we want!</code></pre>
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Treatment    2 14.723   7.361   111.3 1.01e-09 ***
Residuals   15  0.992   0.066                     
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The output is similar to an ANOVA table. ‘Pr(&gt;F)’ is the associated p-value. As the p-value is less than 0.05, the null hypothesis is rejected. So, at least one of the treatments is different. Now that we know that differences exist between our treatments, how can we find which treatments are different? We can do this by using Tukey’s post-hoc test. If you scroll down the help page of <code>aov</code> and go the section ‘See Also’, you will see a function <code>TukeyHSD</code>. This is what we need.</p>
<pre class="r"><code>&gt; TukeyHSD(fit_yield) </code></pre>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Yield_bu_per_acre ~ Treatment, data = fungicide)

$Treatment
                            diff        lwr       upr    p adj
Fungicide_A-Control     0.030000 -0.3557208 0.4157208 0.977785
Fungicide_B-Control     1.933333  1.5476125 2.3190542 0.000000
Fungicide_B-Fungicide_A 1.903333  1.5176125 2.2890542 0.000000</code></pre>
<p>There is no difference between ‘Fungicide_A’ and ‘Control’ as the p-value is 0.978 (&gt;0.05).</p>
<p>Let’s do similar analysis using the Severity data</p>
<pre class="r"><code>&gt; fit_severity &lt;- aov(formula=Severity ~ Treatment, data=fungicide)
&gt; summary(fit_severity) # p-value is less than 0.05, so let&#39;s do Tukey&#39;s post-hoc test</code></pre>
<pre><code>            Df Sum Sq Mean Sq F value  Pr(&gt;F)    
Treatment    2  6.401   3.201   323.7 4.6e-13 ***
Residuals   15  0.148   0.010                    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>&gt; TukeyHSD(fit_severity) </code></pre>
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level

Fit: aov(formula = Severity ~ Treatment, data = fungicide)

$Treatment
                             diff        lwr        upr    p adj
Fungicide_A-Control     -0.400000 -0.5491295 -0.2508705 1.28e-05
Fungicide_B-Control     -1.416667 -1.5657962 -1.2675371 0.00e+00
Fungicide_B-Fungicide_A -1.016667 -1.1657962 -0.8675371 0.00e+00</code></pre>
<p>All the treatment pairs are significantly different from each other as the p-value is &lt; 0.05. Now we’re ready to move on to Part 3, visualizations.</p>
</div>
</div>

<br>
<center>
<a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
</center>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
